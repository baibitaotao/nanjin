(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f675a11c","chunk-2041eca5","chunk-2d0e648a","chunk-2d2225a1"],{"04e1":function(t,e,a){"use strict";var i=a("e45b"),n=a.n(i);n.a},4421:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("div",[a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入二级分类/产品名称/申请单号搜索"},model:{value:t.queryParams.keyWord,callback:function(e){t.$set(t.queryParams,"keyWord",e)},expression:"queryParams.keyWord"}}),t._v(" "),a("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"mini"},on:{click:t.search},slot:"append"},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{slot:"append",icon:"el-icon-delete",size:"mini"},on:{click:t.clear},slot:"append"},[t._v("清空")])],1),t._v(" "),a("a",{on:{click:t.conditionsOn}},[t._v(t._s(t.showCondition))]),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowCondition,expression:"isShowCondition"}],staticClass:"conditions"})]),t._v(" "),a("el-divider"),t._v(" "),a("div",{staticClass:"optionButtons"},t._l(t.buttons,function(e,i){return a("el-button",{key:i,attrs:{disabled:t.setStatus(e.btnScope),type:"danger",plain:"",size:"mini"},on:{click:function(a){return t.option(e.code)}}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),a("div",{staticClass:"bottom"},[a("span",[t._v("全部结果")]),t._v("  \n    "),a("span",[t._v("共"+t._s(t.allItem)+"个结果")]),t._v(" "),a("my-table",{ref:"myTable",attrs:{"query-params":t.queryParams},on:{transferSelectItem:t.transferSelectItem}})],1),t._v(" "),a("add-or-modify",{ref:"addOrModify",on:{getTableList:t.getTableList}}),t._v(" "),a("detail",{ref:"detail"})],1)},n=[],l=(a("ac6a"),a("cdf0")),s=a("d312"),o=a("97a7"),r={name:"",components:{myTable:l["default"],addOrModify:s["default"],detail:o["default"]},data:function(){return{seletedItem:[],queryParams:{currPage:1,pageSize:10,keyWord:""},fixedData:{applyNo:"",applicantDepartment:"",applyTime:"",applicantName:""},showConditionIcon:"el-icon-arrow-up",showCondition:"收起全部筛选项",isShowCondition:!0,allItem:0,buttons:[{code:"111",name:"新增",btnScope:"normal"},{code:"112",name:"编辑",btnScope:"single"},{code:"115",name:"查看",btnScope:"single"},{code:"113",name:"删除",btnScope:"multi"}]}},watch:{queryParams:{handler:function(t,e){""!==t.endTime&&""!==t.startTime&&t.endTime<t.startTime&&(this.$message.warning("结束时间不能小于开始时间"),this.queryParams.endTime="")},deep:!0}},methods:{clear:function(){this.queryParams.keyWord="",this.queryParams.startTime="",this.queryParams.endTime=""},search:function(){this.getTableList()},conditionsOn:function(){"el-icon-arrow-up"===this.showConditionIcon?(this.showConditionIcon="el-icon-arrow-down",this.showCondition="展开全部筛选项",this.isShowCondition=!1):"el-icon-arrow-down"===this.showConditionIcon&&(this.showConditionIcon="el-icon-arrow-up",this.showCondition="收起全部筛选项",this.isShowCondition=!0)},unique:function(t){for(var e,a=[],i={},n=0;null!=(e=t[n]);n++)i[e]||(a.push(e),i[e]=!0);return a},option:function(t){var e=this;if("111"==t){var a={dealMark:"add"};this.$store.dispatch("assetsUse/assetsUseToEdit",a).then(function(a){e.fixedData.applyNo=a.data.applyNo,e.fixedData.applicantDepartment=a.data.applicantDepartment,e.fixedData.applyTime=a.data.applyTime,e.fixedData.applicantName=a.data.applicantName,e.$refs.addOrModify.showDialog(t,e.fixedData)})}else if("112"==t){if("0"!==this.seletedItem[0].applyStatus)return this.$message.warning("此条数据非草稿状态!");this.$refs.addOrModify.showDialog(t,this.seletedItem)}else if("113"==t){var i=!0;if(this.seletedItem.forEach(function(t){if("0"!==t.applyStatus)return i=!1}),!1===i)return this.$message.warning("所选数据存在非草稿状态!");this.$confirm("是否确认删除选中数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.seletedItem.forEach(function(e){t.push(e.applyNo)}),e.$store.dispatch("assetsUse/officePurchaseDelete",t.join(",")).then(function(t){"0"==t.status&&(e.$message.success("删除成功"),e.getTableList())})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}else if("114"==t){if("2"==this.seletedItem[0].vacationStatus)return this.$message.warning("已销假");this.$confirm("是否确定销假?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={type:"VACATION",applyNo:e.seletedItem[0].applyNo};e.$store.dispatch("applyVacation/reportBackReportBack",t).then(function(t){"0"==t.status&&(e.$message.success("销假成功"),e.getTableList())})}).catch(function(){e.$message({type:"info",message:"已取消"})})}else"115"==t&&this.$refs.detail.showDialog(this.seletedItem)},getTableList:function(){this.$refs.myTable.getTableList()},transferSelectItem:function(t){this.seletedItem=t},setStatus:function(t){return"single"==t?1!=this.seletedItem.length:"multi"==t?!(this.seletedItem.length>=1):"normal"!=t}}},c=r,u=a("2877"),p=Object(u["a"])(c,i,n,!1,null,null,null);e["default"]=p.exports},"97a7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail"},[a("el-dialog",{attrs:{title:"详情页",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-row",[t._l(t.data,function(e,i,n){return a("el-col",{key:n,attrs:{span:12}},[a("div",{staticClass:"left"},[t._v(t._s(t._f("getTitle")(i)))]),t._v(" "),a("div",{staticClass:"right"},[t._v(t._s(e))])])}),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"left"},[t._v("总金额")]),t._v(" "),a("div",{staticClass:"right"},[t._v(t._s(t.totalMoney))])]),t._v(" "),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"left"},[t._v("备注")]),t._v(" "),a("div",{staticClass:"right"},[t._v(t._s(t.remark))])])],2),t._v(" "),a("el-row",{staticStyle:{borderTop:"0px",marginTop:"20px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.officePurchaseVOS,border:""}},[a("el-table-column",{attrs:{prop:"patentName",label:"二级分类"}}),t._v(" "),a("el-table-column",{attrs:{prop:"itemName",label:"产品名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applyNumber",label:"申请数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"unitPrice",label:"单价(元)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"money",label:"金额(元)"}})],1)],1)],1)],1)},n=[],l={filters:{getTitle:function(t){return"applicantDepartment"==t?"所在的部门":"applicantName"==t?"姓名":"applyName"==t?"会议名称":"applyNo"==t?"表单号":"applyStatusName"==t?"状态":"applyTime"==t?"申请日期":"remark"==t?"备注":void 0}},data:function(){return{dialogFormVisible:!1,data:{},fileToken:"",officePurchaseVOS:[],remark:"",totalMoney:""}},methods:{showDialog:function(t){this.dialogFormVisible=!this.dialogFormVisible,this.data.applicantDepartment=t[0].applicantDepartment,this.data.applicantName=t[0].applicantName,this.data.applyStatusName=t[0].applyStatusName,this.data.applyNo=t[0].applyNo,this.data.applyTime=t[0].applyTime,this.remark=t[0].remark,this.totalMoney=t[0].totalMoney,this.officePurchaseVOS=t[0].officePurchaseVOS}}},s=l,o=a("2877"),r=Object(o["a"])(s,i,n,!1,null,null,null);e["default"]=r.exports},cdf0:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applyNo",label:"申请单号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"patentName",label:"二级分类"}}),t._v(" "),a("el-table-column",{attrs:{prop:"itemName",label:"产品名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applyNumber",label:"申请数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applyTime",label:"申请日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applyStatusName",label:"状态"}})],1),t._v(" "),a("div",[a("el-pagination",{attrs:{"current-page":t.queryParams.currPage,background:"",small:"","page-sizes":[10,20,30,40],layout:" prev, pager, next,total ,sizes ,jumper",total:t.totalPage},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},n=[],l={props:{queryParams:{type:Object,required:!0}},data:function(){return{tableData:[],totalPage:0}},mounted:function(){this.getTableList()},methods:{getTableList:function(){var t=this;this.$store.dispatch("bangonyonpincaigou/officePurchaseList",this.queryParams).then(function(e){t.tableData=e.data,t.totalPage=e.totalCount,t.$parent.allItem=t.totalPage})},handleSizeChange:function(t){this.queryParams.pageSize=t,this.getTableList()},handleCurrentChange:function(t){this.queryParams.currPage=t,this.getTableList()},handleSelectionChange:function(t){this.$emit("transferSelectItem",t)}}},s=l,o=a("2877"),r=Object(o["a"])(s,i,n,!1,null,null,null);e["default"]=r.exports},d312:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addOrModify"},[a("el-dialog",{attrs:{title:"采购申请新增",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"申请单号"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.fixedData.applyNo,callback:function(e){t.$set(t.fixedData,"applyNo",e)},expression:"fixedData.applyNo"}})],1)],1)]),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:"申请部门"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.fixedData.applicantDepartment,callback:function(e){t.$set(t.fixedData,"applicantDepartment",e)},expression:"fixedData.applicantDepartment"}})],1)],1)])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"申请人"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.fixedData.applicantName,callback:function(e){t.$set(t.fixedData,"applicantName",e)},expression:"fixedData.applicantName"}})],1)],1)]),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:"申请日期"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.fixedData.applyTime,callback:function(e){t.$set(t.fixedData,"applyTime",e)},expression:"fixedData.applyTime"}})],1)],1)])],1),t._v(" "),a("el-row",{staticClass:"vacationTime"},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:"总金额"}},[a("el-input",{attrs:{value:t.totalMoney,disabled:!0}})],1)],1)])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple waichureason"},[a("el-form-item",{attrs:{label:"备注",prop:"reason"}},[a("el-input",{attrs:{type:"textarea",rows:"3",cols:"110"},model:{value:t.fixedData.remark,callback:function(e){t.$set(t.fixedData,"remark",e)},expression:"fixedData.remark"}})],1)],1)])],1)],1),t._v(" "),a("div",{staticStyle:{marginTop:"10px"}},[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:t.add}},[t._v("新增")])],1),t._v(" "),a("el-form",{ref:"applyRule",staticStyle:{marginTop:"10px"},attrs:{model:t.ruleForm,rules:t.rules}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.applyTableData,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{label:"二级分类"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return t.secondChange(e.row)}},model:{value:e.row.patentId,callback:function(a){t.$set(e.row,"patentId",a)},expression:"scope.row.patentId"}},t._l(t.secondOptions,function(t){return a("el-option",{key:t.itemId,attrs:{label:t.itemName,value:t.itemId}})}),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.row.itemId,callback:function(a){t.$set(e.row,"itemId",a)},expression:"scope.row.itemId"}},t._l(t.productName(e.row.patentId,e.row),function(t){return a("el-option",{key:t.itemId,attrs:{label:t.itemName,value:t.itemId}})}),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.row.unit,callback:function(a){t.$set(e.row,"unit",a)},expression:"scope.row.unit"}},t._l(t.unitOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"库存数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:!0,value:t.kucunAmount(e.row)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"申请数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{model:{value:e.row.applyNumber,callback:function(a){t.$set(e.row,"applyNumber",a)},expression:"scope.row.applyNumber"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"单价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{model:{value:e.row.unitPrice,callback:function(a){t.$set(e.row,"unitPrice",a)},expression:"scope.row.unitPrice"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:!0,value:t.calculateMoney(e.row)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{color:"#980004"},attrs:{type:"text",size:"mini"},on:{click:function(a){return t.del(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"submit"},[t.isAddOrMOdify?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.submitForm("ruleForm","save")}}},[t._v("保存")]):t._e(),t._v(" "),t.isAddOrMOdify?t._e():a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.submitForm("ruleForm","update")}}},[t._v("更新")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.submitForm("ruleForm","submit")}}},[t._v("提交")])],1)],1)],1)},n=[],l=(a("c5f6"),a("ac6a"),{data:function(){return{totalMoney:0,applyTableData:[],isAddOrMOdify:"",dialogFormVisible:!1,formLabelWidth:"120",secondOptions:[],unitOptions:[],ruleForm:{applyName:"",attachment:"",vacationTime:[],reason:""},fixedData:{remark:""},rules:{vacationTime:[{required:"true",message:"请假时间必填",trigger:"change"}],applyName:[{required:"true",message:"请假标题",trigger:"change"}],reason:[{required:"true",message:"请假事由必填",trigger:"blur"}]},newId:0}},watch:{applyTableData:{handler:function(t,e){var a=[],i=0;t.forEach(function(t){""!==t.applyNumber&&""!==t.unitPrice&&a.push(t)}),a.forEach(function(t){i+=t.applyNumber*t.unitPrice}),this.totalMoney=i},deep:!0}},methods:{showDialog:function(t,e){var a=this;if(this.dialogFormVisible=!this.dialogFormVisible,this.$store.dispatch("officeStock/selectItemList",{classify:0}).then(function(t){a.secondOptions=t.data}),this.$store.dispatch("officeStock/commonTCodeGetCodeByParentIdVal","11002").then(function(t){var e=[];t.data.options.forEach(function(t){var a={};a.value=Number(t.value),a.label=t.label,e.push(a)}),a.unitOptions=e}),"111"===t)this.fixedData.applyNo=e.applyNo,this.fixedData.applicantDepartment=e.applicantDepartment,this.fixedData.applyTime=e.applyTime,this.fixedData.applicantName=e.applicantName,this.fixedData.remark="",this.applyTableData=[],this.isAddOrMOdify=!0;else if("112"===t){this.fixedData.applyNo=e[0].applyNo,this.fixedData.applicantDepartment=e[0].applicantDepartment,this.fixedData.applyTime=e[0].applyTime,this.fixedData.applicantName=e[0].applicantName,this.fixedData.remark=e[0].remark;var i=[];e[0].officePurchaseVOS.forEach(function(t){t.newId=++a.newId,i.push(t)}),this.applyTableData=i,this.isAddOrMOdify=!1}},submitForm:function(t,e){var a=this,i=!0;if(0===this.applyTableData.length)return this.$message.warning("申请产品不能为空!");if(this.applyTableData.forEach(function(t){for(var e in t)if(""===t[e])return i=!1,a.$message.warning("申请产品参数存在空值!")}),i){var n={};n.applyNo=this.fixedData.applyNo,n.remark=this.fixedData.remark,n.officePurchaseDTOS=this.applyTableData,"save"===e?this.$store.dispatch("assetsUse/officePurchaseAdd",n).then(function(t){"0"===t.status&&(a.$message.success("新增成功!"),a.dialogFormVisible=!a.dialogFormVisible,a.$emit("getTableList"))}):"update"===e?this.$store.dispatch("assetsUse/officePurchaseUpdate",n).then(function(t){"0"===t.status&&(a.$message.success("更新成功!"),a.dialogFormVisible=!a.dialogFormVisible,a.$emit("getTableList"))}):"submit"===e&&this.$store.dispatch("assetsUse/officePurchaseConditionProcessSubmit",n).then(function(t){"0"===t.status&&(a.$message.success("提交成功!"),a.dialogFormVisible=!a.dialogFormVisible,a.$emit("getTableList"))})}},del:function(t){var e=this;this.applyTableData.forEach(function(a,i){if(a.newId===t.newId)return e.applyTableData.splice(i,1),e.$message.success("已删除")})},add:function(){var t={};t.newId=++this.newId,t.patentId="",t.itemId="",t.unit="",t.applyNumber="",t.unitPrice="",this.applyTableData.push(t)},productName:function(t,e){var a=[];return this.secondOptions.forEach(function(e){t===e.itemId&&(a=e.itemList)}),a},getVal:function(t,e){Number(t)>this.kucunAmount(e)&&(this.$message.error("申请数量不能大于库存数量!"),e.applyNumber="")},calculateMoney:function(t){var e="";return""!==t.unit&&""!==t.unitPrice&&(e=t.applyNumber*Number(t.unitPrice)),e},kucunAmount:function(t){var e="";return""!==t.itemId&&""!==t.patentId?this.secondOptions.forEach(function(a){a.itemId===t.patentId&&a.itemList.forEach(function(a){a.itemId===t.itemId&&(e=a.stockAmount)})}):e="",e},secondChange:function(t){t.itemId="",t.unit=""}}}),s=l,o=(a("04e1"),a("2877")),r=Object(o["a"])(s,i,n,!1,null,null,null);e["default"]=r.exports},e45b:function(t,e,a){}}]);