(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d237f01"],{fcf4:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"addOrModifyLC"},[r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("el-form-item",{attrs:{label:"分配物品编号"}},[r("el-select",{staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.ruleForm.model,callback:function(t){e.$set(e.ruleForm,"model",t)},expression:"ruleForm.model"}},e._l(e.modelOption,function(e){return r("el-option",{key:e,attrs:{label:e,size:"small",value:e}})}),1)],1)],1)])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{attrs:{type:"textarea",rows:"3",cols:"110"},model:{value:e.ruleForm.deparameter,callback:function(t){e.$set(e.ruleForm,"deparameter",t)},expression:"ruleForm.deparameter"}})],1)],1)])],1)],1)],1)},s=[],a=(r("ac6a"),r("c5f6"),{props:["modelOption"],data:function(){var e=function(e,t,r){""===t?r(new Error("请输入领用数量")):/^[1-9]+[0-9]*$/.test(t)?r():r(new Error("领用数量不符合规则"))};return{isAddOrMOdify:"",stockTypeOptions:[],patentIdOptions:[],unitOptions:[],allItem:[],formLabelWidth:"120",ruleForm:{model:"",unitPrice:"",deparameter:""},fixedData:{},useId:"",rules:{useAmount:[{required:"true",validator:e,trigger:"blur"}],itemId:[{required:"true",message:"用品类别必填",trigger:"change"}],pItemId:[{required:"true",message:"库存类别必填",trigger:"change"}],remark:[{required:"false",trigger:"blur"},{min:0,max:5,message:"长度在 0 到 5 个字符",trigger:"blur"}],applyName:[{required:"true",message:"申请标题必填",trigger:"blur"}]}}},computed:{totalPrice:function(){return Number(this.applyAmount)*Number(this.ruleForm.unitPrice)},pItemId:function(){return this.ruleForm.pItemId},itemId:function(){return this.ruleForm.itemId},itemIdOptions:function(){var e=this,t=[];return this.allItem.forEach(function(r){0!==r.length&&r[0].patentId===e.ruleForm.pItemId&&r.forEach(function(e){var r={};r.itemName=e.itemName,r.itemId=Number(e.itemId),t.push(r)})}),t}},watch:{itemId:function(e,t){var r=this;this.allItem.forEach(function(t){t.forEach(function(t){if(t.itemId===e)return r.ruleForm.stockAmount=t.stockAmount})})},pItemId:function(e,t){this.ruleForm.itemId=""}},methods:{showDialog:function(e,t){var r=this;this.$store.dispatch("officeStock/selectItemList",{classify:0}).then(function(e){var t=[];r.allItem=[],e.data.forEach(function(e){var i={};i.pItemName=e.itemName,i.pItemId=Number(e.itemId),t.push(i),r.allItem.push(e.itemList)}),r.patentIdOptions=t}),"111"===e?(this.isAddOrMOdify=!0,this.ruleForm.stockAmount="",this.ruleForm.applyName="",this.ruleForm.itemId="",this.ruleForm.pItemId="",this.ruleForm.remark="",this.ruleForm.useAmount="",this.fixedData=t):"112"===e&&(this.isAddOrMOdify=!1,this.fixedData.applyNo=t.applyNo,this.fixedData.applicantDepartment=t.applicantDepartment,this.fixedData.applyTime=t.applyTime,this.fixedData.applicantName=t.applicantName,this.ruleForm.applyName=t.applyName,this.ruleForm.stockAmount=t.stockAmount,this.ruleForm.remark=t.remark,this.ruleForm.useAmount=t.useAmount,this.ruleForm.pItemId=Number(t.patentId),this.$nextTick(function(){r.ruleForm.itemId=Number(t.itemId)}),this.useId=t.useId),this.$nextTick(function(){r.$refs.ruleForm.clearValidate()})},submitForm:function(e,t){var r=this,i={};if(this.ruleForm.useAmount>this.ruleForm.stockAmount)return this.ruleForm.useAmount="",this.$message.warning("领用数不能大于库存数");this.isAddOrMOdify?(i.applyName=this.ruleForm.applyName,i.itemId=this.ruleForm.itemId,i.patentId=this.ruleForm.pItemId,i.remark=this.ruleForm.remark,i.useAmount=this.ruleForm.useAmount,i.applyNo=this.fixedData.applyNo):this.isAddOrMOdify||(i.model=this.ruleForm.model.join(","),i.remark=this.ruleForm.remark,i.applyNo=e.applyNo,i.useId=e.useId),"save"===t?this.$store.dispatch(this.isAddOrMOdify?"useController/officeUseAdd":"useController/officeUseUpdate",i).then(function(e){"0"===e.status&&(r.$message.success(r.isAddOrMOdify?"新增成功":"更新成功"),r.$emit("getTableList"),r.dialogFormVisible=!r.dialogFormVisible)}):"update"===t&&(console.log(i),this.$store.dispatch("LC/assetsUseUpdateApproval",i).then(function(e){}))}}}),o=a,l=r("2877"),m=Object(l["a"])(o,i,s,!1,null,null,null);t["default"]=m.exports}}]);